<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Music Mood Mapper</title>
    <style>
        body {
          font-family: Arial, sans-serif;
          max-width: 900px;
          margin: 20px auto;
          padding: 0 12px;
        }

        h1 {
          text-align: center;
          margin-bottom: 4px;
        }

        .subtitle {
          text-align: center;
          font-size: 0.9rem;
          color: #555;
          margin-bottom: 20px;
        }

        .layout {
          display: grid;
          grid-template-columns: 1.2fr 1fr;
          gap: 18px;
          align-items: flex-start;
        }

        .card {
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 12px 14px;
          box-shadow: 0 1px 3px rgba(0,0,0,0.08);
          background-color: #fafafa;
        }

        .card h2 {
          font-size: 1.1rem;
          margin-top: 0;
          margin-bottom: 10px;
        }

        form {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 8px 10px;
        }

        label {
          font-size: 0.85rem;
          display: block;
          margin-bottom: 2px;
        }

        input[type="text"],
        select,
        input[type="number"],
        textarea {
          width: 100%;
          padding: 6px;
          font-size: 0.9rem;
          border-radius: 4px;
          border: 1px solid #ccc;
          box-sizing: border-box;
        }

        textarea {
          resize: vertical;
          min-height: 50px;
        }

        .full-width {
          grid-column: 1 / 3;
        }

        button {
          cursor: pointer;
          padding: 7px 10px;
          border-radius: 4px;
          border: none;
          font-size: 0.9rem;
        }

        .btn-primary {
          background-color: #2563eb;
          color: white;
        }

        .btn-secondary {
          background-color: #e5e7eb;
          color: #111827;
        }

        .controls {
          display: flex;
          align-items: center;
          gap: 10px;
          margin-top: 6px;
          margin-bottom: 6px;
          font-size: 0.85rem;
        }

        table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 10px;
          font-size: 0.85rem;
        }

        th, td {
          border: 1px solid #ddd;
          padding: 6px 4px;
          text-align: left;
        }

        th {
          background-color: #f3f4f6;
        }

        .tag {
          display: inline-block;
          padding: 2px 6px;
          border-radius: 10px;
          font-size: 0.75rem;
          margin-right: 4px;
        }

        .tag-hype { background-color: #fee2e2; }
        .tag-chill { background-color: #e0f2fe; }
        .tag-focus { background-color: #dcfce7; }
        .tag-sad { background-color: #f3e8ff; }
        .tag-confident { background-color: #fef3c7; }

        .summary-item {
          font-size: 0.9rem;
          margin-bottom: 4px;
        }

        .small-text {
          font-size: 0.8rem;
          color: #6b7280;
        }
    </style>
</head>
<body>
<h1>Music Mood Mapper</h1>
<p class="subtitle">
    Log songs you love, tag their mood and energy, and see your personal "emotional playlist" profile.
</p>

<div class="layout">
    <!-- Left: form and filters -->
    <div class="card">
        <h2>Add a song</h2>
        <form id="song-form">
            <div>
                <label for="title">Song title</label>
                <input type="text" id="title" required placeholder="Example: Rich Baby Daddy">
            </div>
            <div>
                <label for="artist">Artist</label>
                <input type="text" id="artist" required placeholder="Example: Drake">
            </div>

            <div>
                <label for="mood">Mood</label>
                <select id="mood" required>
                    <option value="">Select mood</option>
                    <option value="hype">Hype</option>
                    <option value="chill">Chill</option>
                    <option value="focus">Focus</option>
                    <option value="sad">Sad</option>
                    <option value="confident">Confident</option>
                </select>
            </div>

            <div>
                <label for="energy">Energy (1 to 5)</label>
                <input type="number" id="energy" min="1" max="5" required>
            </div>

            <div class="full-width">
                <label for="context">When do you play this song?</label>
                <textarea id="context" placeholder="Example: Pre game, late night drive, studying, cutting hair, etc."></textarea>
            </div>

            <div class="full-width">
                <button type="submit" class="btn-primary">Add to mood map</button>
                <button type="button" id="clear-all" class="btn-secondary">Clear all songs</button>
            </div>
        </form>

        <hr style="margin: 16px 0;">

        <h2>Filter</h2>
        <div class="controls">
            <label for="filter-mood">Mood filter:</label>
            <select id="filter-mood">
                <option value="all">All moods</option>
                <option value="hype">Hype</option>
                <option value="chill">Chill</option>
                <option value="focus">Focus</option>
                <option value="sad">Sad</option>
                <option value="confident">Confident</option>
            </select>

            <label for="min-energy">Min energy:</label>
            <input type="number" id="min-energy" min="1" max="5" value="1" style="width: 50px;">
            <button type="button" id="reset-filters" class="btn-secondary">Reset</button>
        </div>
        <p class="small-text">
            Tip: Play with mood + energy filters and imagine you are building mini playlists for different situations.
        </p>
    </div>

    <!-- Right: table and summary -->
    <div class="card">
        <h2>Your songs</h2>
        <table>
            <thead>
            <tr>
                <th>Song</th>
                <th>Artist</th>
                <th>Mood</th>
                <th>Energy</th>
            </tr>
            </thead>
            <tbody id="songs-body">
            <!-- Songs will appear here -->
            </tbody>
        </table>

        <h2 style="margin-top: 14px;">Mood summary</h2>
        <div id="summary">
            <p class="small-text">No songs yet. Add a few to see your mood profile.</p>
        </div>
    </div>
</div>

<script>
    const songForm = document.getElementById('song-form');
    const songsBody = document.getElementById('songs-body');
    const filterMood = document.getElementById('filter-mood');
    const minEnergyInput = document.getElementById('min-energy');
    const resetFiltersBtn = document.getElementById('reset-filters');
    const clearAllBtn = document.getElementById('clear-all');
    const summaryDiv = document.getElementById('summary');

    let songs = [];

    function loadFromStorage() {
      const raw = localStorage.getItem('musicMoodSongs');
      if (!raw) return;
      try {
        const parsed = JSON.parse(raw);
        if (Array.isArray(parsed)) {
          songs = parsed;
        }
      } catch (e) {
        console.error('Could not parse songs from storage', e);
      }
    }

    function saveToStorage() {
      localStorage.setItem('musicMoodSongs', JSON.stringify(songs));
    }

    function moodTagClass(mood) {
      return {
        hype: 'tag-hype',
        chill: 'tag-chill',
        focus: 'tag-focus',
        sad: 'tag-sad',
        confident: 'tag-confident'
      }[mood] || '';
    }

    function moodLabel(mood) {
      switch (mood) {
        case 'hype': return 'Hype';
        case 'chill': return 'Chill';
        case 'focus': return 'Focus';
        case 'sad': return 'Sad';
        case 'confident': return 'Confident';
        default: return mood;
      }
    }

    function renderSongs() {
      songsBody.innerHTML = '';

      const selectedMood = filterMood.value;
      const minEnergy = Number(minEnergyInput.value) || 1;

      const filtered = songs.filter(song => {
        const moodMatches = selectedMood === 'all' || song.mood === selectedMood;
        const energyMatches = song.energy >= minEnergy;
        return moodMatches && energyMatches;
      });

      if (filtered.length === 0) {
        const row = document.createElement('tr');
        const cell = document.createElement('td');
        cell.colSpan = 4;
        cell.textContent = 'No songs yet for this filter.';
        row.appendChild(cell);
        songsBody.appendChild(row);
        return;
      }

      filtered.forEach(song => {
        const row = document.createElement('tr');

        const titleCell = document.createElement('td');
        titleCell.textContent = song.title;

        const artistCell = document.createElement('td');
        artistCell.textContent = song.artist;

        const moodCell = document.createElement('td');
        const span = document.createElement('span');
        span.textContent = moodLabel(song.mood);
        span.className = 'tag ' + moodTagClass(song.mood);
        moodCell.appendChild(span);

        const energyCell = document.createElement('td');
        energyCell.textContent = song.energy;

        row.appendChild(titleCell);
        row.appendChild(artistCell);
        row.appendChild(moodCell);
        row.appendChild(energyCell);

        songsBody.appendChild(row);
      });
    }

    function renderSummary() {
      if (songs.length === 0) {
        summaryDiv.innerHTML = '<p class="small-text">No songs yet. Add a few to see your mood profile.</p>';
        return;
      }

      const counts = {
        hype: 0,
        chill: 0,
        focus: 0,
        sad: 0,
        confident: 0
      };

      let totalEnergy = 0;

      songs.forEach(song => {
        if (counts.hasOwnProperty(song.mood)) {
          counts[song.mood] += 1;
        }
        totalEnergy += song.energy;
      });

      const totalSongs = songs.length;
      const averageEnergy = totalSongs > 0 ? (totalEnergy / totalSongs).toFixed(1) : '0.0';

      let favoriteMood = null;
      let favoriteCount = 0;
      for (const mood in counts) {
        if (counts[mood] > favoriteCount) {
          favoriteCount = counts[mood];
          favoriteMood = mood;
        }
      }

      const favoriteMoodLabel = favoriteMood ? moodLabel(favoriteMood) : 'None yet';

      summaryDiv.innerHTML = `
        <p class="summary-item"><strong>Total songs logged:</strong> ${totalSongs}</p>
        <p class="summary-item"><strong>Average energy:</strong> ${averageEnergy} out of 5</p>
        <p class="summary-item"><strong>Most common mood:</strong> ${favoriteMoodLabel}</p>
        <p class="small-text">You can talk about this app in interviews as a way you connect music, mood, and "use cases" like a product manager.</p>
      `;
    }

    songForm.addEventListener('submit', function (event) {
      event.preventDefault();

      const title = document.getElementById('title').value.trim();
      const artist = document.getElementById('artist').value.trim();
      const mood = document.getElementById('mood').value;
      const energyValue = document.getElementById('energy').value;
      const context = document.getElementById('context').value.trim();

      const energy = Number(energyValue);

      if (!title || !artist || !mood || !energyValue) {
        alert('Please fill in song title, artist, mood, and energy.');
        return;
      }

      if (energy < 1 || energy > 5) {
        alert('Energy must be between 1 and 5.');
        return;
      }

      const newSong = {
        title,
        artist,
        mood,
        energy,
        context
      };

      songs.push(newSong);
      saveToStorage();
      renderSongs();
      renderSummary();
      songForm.reset();
    });

    filterMood.addEventListener('change', function () {
      renderSongs();
    });

    minEnergyInput.addEventListener('input', function () {
      renderSongs();
    });

    resetFiltersBtn.addEventListener('click', function () {
      filterMood.value = 'all';
      minEnergyInput.value = '1';
      renderSongs();
    });

    clearAllBtn.addEventListener('click', function () {
      if (!confirm('Clear all songs from your mood map? This cannot be undone.')) {
        return;
      }
      songs = [];
      saveToStorage();
      renderSongs();
      renderSummary();
    });

    loadFromStorage();
    renderSongs();
    renderSummary();
</script>
</body>
</html>
